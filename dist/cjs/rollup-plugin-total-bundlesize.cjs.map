{"version":3,"file":"rollup-plugin-total-bundlesize.cjs","sources":["../../src/rollupPluginTotalBundlesize.js"],"sourcesContent":["// @ts-nocheck\nimport boxen from 'boxen';\nimport filesize from 'rollup-plugin-filesize';\n\nconst colors = {\n  reset: '\\x1b[0m',\n  yellowBright: '\\x1b[93m',\n  cyan: '\\x1b[36m',\n  blackBright: '\\x1b[90m',\n  green: '\\x1b[32m',\n};\n\nexport default (boxenOptions = {}) => {\n  const boxenOptionsDefault = {\n    padding: {\n      top: 0,\n      right: 1,\n      bottom: 0,\n      left: 1,\n    },\n    title: 'Total size',\n    borderStyle: 'single',\n    ...boxenOptions,\n  };\n\n  /**\n   * @param {string} value\n   * @returns {number}\n   */\n  const calculateByteSize = (value) => {\n    let [num, unit] = value.split(' ');\n    switch (unit) {\n      case 'B':\n        return parseFloat(num);\n      case 'KB':\n        return parseFloat(num) * 1e3;\n      case 'MB':\n        return parseFloat(num) * 1e6;\n      case 'GB':\n        return parseFloat(num) * 1e9;\n      default:\n        return num;\n    }\n  };\n\n  /**\n   * @param {number} num\n   * @returns {string}\n   */\n  const toReadableNumber = (num) => {\n    return num.toLocaleString('en', { maximumFractionDigits: 2 });\n  };\n\n  /**\n   * @param {number} value\n   * @returns {string}\n   */\n  const getReadableSize = (value) => {\n    let result;\n    value = parseFloat(value);\n    switch (true) {\n      case value < 1e3:\n        result = toReadableNumber(value) + ' B';\n        break;\n      case value >= 1e3 && value < 1e6:\n        result = toReadableNumber(value / 1e3) + ' KB';\n        break;\n      case value >= 1e6 && value < 1e9:\n        result = toReadableNumber(value / 1e6) + ' MB';\n        break;\n      case value >= 1e9 && value < 1e12:\n        result = toReadableNumber(value / 1e6) + ' GB';\n        break;\n      default:\n        result = String(value.toFixed());\n    }\n    return result;\n  };\n\n  let totalBundleSize = 0;\n  let totalMinSize = 0;\n  let totalGzipSize = 0;\n  let totalBrotliSize = 0;\n\n  return {\n    name: 'rollup-plugin-total-bundlesize',\n    generateBundle: async (...args) => {\n      await filesize({\n        showBrotliSize: true,\n        reporter: (options, bundle, { fileName, bundleSize, minSize, gzipSize, brotliSize }) => {\n          totalBundleSize += calculateByteSize(bundleSize);\n          totalMinSize += calculateByteSize(minSize);\n          totalGzipSize += calculateByteSize(gzipSize);\n          totalBrotliSize += calculateByteSize(brotliSize);\n        },\n      }).generateBundle(...args);\n\n      const output = `${colors.cyan}Bundle:${colors.reset}${colors.blackBright}${getReadableSize(\n        totalBundleSize\n      )}${colors.reset} | ${colors.cyan}Minified:${colors.reset}${\n        colors.blackBright\n      }${getReadableSize(totalMinSize)}${colors.reset} | ${colors.cyan}Gzipped:${\n        colors.blackBright\n      }${getReadableSize(totalGzipSize)}${colors.reset} | ${colors.cyan}Brotli:${colors.reset}${\n        colors.blackBright\n      }${getReadableSize(totalBrotliSize)}`;\n\n      console.log('\\n');\n      console.log(colors.reset);\n      console.log(boxen(`${colors.yellowBright}${output}${colors.reset}`, boxenOptionsDefault));\n    },\n  };\n};\n"],"names":["colors","boxenOptions","boxenOptionsDefault","padding","top","right","bottom","left","title","borderStyle","calculateByteSize","value","num","unit","split","parseFloat","toReadableNumber","toLocaleString","maximumFractionDigits","getReadableSize","result","String","toFixed","totalBundleSize","totalMinSize","totalGzipSize","totalBrotliSize","name","generateBundle","async","args","filesize","showBrotliSize","reporter","options","bundle","fileName","bundleSize","minSize","gzipSize","brotliSize","output","console","log","boxen"],"mappings":"wEAIA,MAAMA,EACG,OADHA,EAEU,QAFVA,EAGE,QAHFA,EAIS,uBAIA,CAACC,EAAe,CAAA,KAC7B,MAAMC,EAAsB,CAC1BC,QAAS,CACPC,IAAK,EACLC,MAAO,EACPC,OAAQ,EACRC,KAAM,GAERC,MAAO,aACPC,YAAa,YACVR,GAOCS,EAAqBC,IACzB,IAAKC,EAAKC,GAAQF,EAAMG,MAAM,KAC9B,OAAQD,GACN,IAAK,IACH,OAAOE,WAAWH,GACpB,IAAK,KACH,OAAyB,IAAlBG,WAAWH,GACpB,IAAK,KACH,OAAyB,IAAlBG,WAAWH,GACpB,IAAK,KACH,OAAyB,IAAlBG,WAAWH,GACpB,QACE,OAAOA,EACV,EAOGI,EAAoBJ,GACjBA,EAAIK,eAAe,KAAM,CAAEC,sBAAuB,IAOrDC,EAAmBR,IACvB,IAAIS,EAEJ,OADAT,EAAQI,WAAWJ,IACX,GACN,KAAKA,EAAQ,IACXS,EAASJ,EAAiBL,GAAS,KACnC,MACF,KAAKA,GAAS,KAAOA,EAAQ,IAC3BS,EAASJ,EAAiBL,EAAQ,KAAO,MACzC,MACF,KAAKA,GAAS,KAAOA,EAAQ,IAC3BS,EAASJ,EAAiBL,EAAQ,KAAO,MACzC,MACF,KAAKA,GAAS,KAAOA,EAAQ,KAC3BS,EAASJ,EAAiBL,EAAQ,KAAO,MACzC,MACF,QACES,EAASC,OAAOV,EAAMW,WAE1B,OAAOF,CAAM,EAGf,IAAIG,EAAkB,EAClBC,EAAe,EACfC,EAAgB,EAChBC,EAAkB,EAEtB,MAAO,CACLC,KAAM,iCACNC,eAAgBC,SAAUC,WAClBC,EAAS,CACbC,gBAAgB,EAChBC,SAAU,CAACC,EAASC,GAAUC,WAAUC,aAAYC,UAASC,WAAUC,iBACrEjB,GAAmBb,EAAkB2B,GACrCb,GAAgBd,EAAkB4B,GAClCb,GAAiBf,EAAkB6B,GACnCb,GAAmBhB,EAAkB8B,EAAW,IAEjDZ,kBAAkBE,GAErB,MAAMW,EAAS,GAAGzC,WAAqBA,IAAeA,IAAqBmB,EACzEI,KACEvB,OAAkBA,aAAuBA,IAC3CA,IACCmB,EAAgBK,KAAgBxB,OAAkBA,YACnDA,IACCmB,EAAgBM,KAAiBzB,OAAkBA,WAAqBA,IACzEA,IACCmB,EAAgBO,KAEnBgB,QAAQC,IAAI,MACZD,QAAQC,IAAI3C,GACZ0C,QAAQC,IAAIC,EAAM,GAAG5C,IAAsByC,IAASzC,IAAgBE,GAAqB,EAE5F"}