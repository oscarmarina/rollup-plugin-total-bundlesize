{"version":3,"file":"rollup-plugin-total-bundlesize.cjs","sources":["../../src/rollupPluginTotalBundlesize.js"],"sourcesContent":["// @ts-nocheck\nimport boxen from 'boxen';\nimport filesize from 'rollup-plugin-filesize';\n\nconst colors = {\n  reset: '\\x1b[0m',\n  yellowBright: '\\x1b[93m',\n  cyan: '\\x1b[36m',\n  blackBright: '\\x1b[90m',\n  green: '\\x1b[32m',\n};\n\nexport default (boxenOptions = {}) => {\n  const boxenOptionsDefault = {\n    padding: {\n      top: 0,\n      right: 1,\n      bottom: 0,\n      left: 1,\n    },\n    title: 'Total size',\n    borderStyle: 'single',\n    ...boxenOptions,\n  };\n\n  /**\n   * @param {string} value\n   * @returns {number}\n   */\n  const calculateByteSize = (value) => {\n    let [num, unit] = value.split(' ');\n    num = parseFloat(num);\n    switch (unit) {\n      case 'B':\n        return num;\n      case 'KB':\n        return num * 1e3;\n      case 'MB':\n        return num * 1e6;\n      case 'GB':\n        return num * 1e9;\n      default:\n        return num; // Return number as-is if unit is unrecognized\n    }\n  };\n\n  /**\n   * @param {number} num\n   * @returns {string}\n   */\n  const toReadableNumber = (num) => {\n    return num.toLocaleString('en', {maximumFractionDigits: 2});\n  };\n\n  /**\n   * @param {number} value\n   * @returns {string}\n   */\n  const getReadableSize = (value) => {\n    let result;\n    value = parseFloat(value);\n    switch (true) {\n      case value < 1e3:\n        result = toReadableNumber(value) + ' B';\n        break;\n      case value >= 1e3 && value < 1e6:\n        result = toReadableNumber(value / 1e3) + ' KB';\n        break;\n      case value >= 1e6 && value < 1e9:\n        result = toReadableNumber(value / 1e6) + ' MB';\n        break;\n      case value >= 1e9 && value < 1e12:\n        result = toReadableNumber(value / 1e9) + ' GB';\n        break;\n      case value >= 1e12:\n        result = toReadableNumber(value / 1e12) + ' TB';\n        break;\n      default:\n        result = toReadableNumber(value) + ' B';\n    }\n    return result;\n  };\n\n  let totalBundleSize = 0;\n  let totalMinSize = 0;\n  let totalGzipSize = 0;\n  let totalBrotliSize = 0;\n\n  return {\n    name: 'rollup-plugin-total-bundlesize',\n    generateBundle: async (...args) => {\n      await filesize({\n        showBrotliSize: true,\n        reporter: (options, bundle, {fileName, bundleSize, minSize, gzipSize, brotliSize}) => {\n          totalBundleSize += calculateByteSize(bundleSize);\n          totalMinSize += calculateByteSize(minSize);\n          totalGzipSize += calculateByteSize(gzipSize);\n          totalBrotliSize += calculateByteSize(brotliSize);\n        },\n      }).generateBundle(...args);\n\n      const output = `${colors.cyan}Bundle:${colors.reset}${colors.blackBright}${getReadableSize(\n        totalBundleSize\n      )}${colors.reset} | ${colors.cyan}Minified:${colors.reset}${\n        colors.blackBright\n      }${getReadableSize(totalMinSize)}${colors.reset} | ${colors.cyan}Gzipped:${\n        colors.blackBright\n      }${getReadableSize(totalGzipSize)}${colors.reset} | ${colors.cyan}Brotli:${colors.reset}${\n        colors.blackBright\n      }${getReadableSize(totalBrotliSize)}`;\n\n      console.log('\\n');\n      console.log(colors.reset);\n      console.log(boxen(`${colors.yellowBright}${output}${colors.reset}`, boxenOptionsDefault));\n    },\n  };\n};\n"],"names":["colors","boxenOptions","boxenOptionsDefault","padding","top","right","bottom","left","title","borderStyle","calculateByteSize","value","num","unit","split","parseFloat","toReadableNumber","toLocaleString","maximumFractionDigits","getReadableSize","result","totalBundleSize","totalMinSize","totalGzipSize","totalBrotliSize","name","generateBundle","async","args","filesize","showBrotliSize","reporter","options","bundle","fileName","bundleSize","minSize","gzipSize","brotliSize","output","console","log","boxen"],"mappings":"wEAIA,MAAMA,EACG,OADHA,EAEU,QAFVA,EAGE,QAHFA,EAIS,uBAIA,CAACC,EAAe,CAAA,KAC7B,MAAMC,EAAsB,CAC1BC,QAAS,CACPC,IAAK,EACLC,MAAO,EACPC,OAAQ,EACRC,KAAM,GAERC,MAAO,aACPC,YAAa,YACVR,GAOCS,EAAqBC,IACzB,IAAKC,EAAKC,GAAQF,EAAMG,MAAM,KAE9B,OADAF,EAAMG,WAAWH,GACTC,GACN,IAAK,IAQL,QACE,OAAOD,EAPT,IAAK,KACH,OAAa,IAANA,EACT,IAAK,KACH,OAAa,IAANA,EACT,IAAK,KACH,OAAa,IAANA,EAGf,EAOQI,EAAoBJ,GACjBA,EAAIK,eAAe,KAAM,CAACC,sBAAuB,IAOpDC,EAAmBR,IACvB,IAAIS,EAEJ,OADAT,EAAQI,WAAWJ,IACX,GACN,KAAKA,EAAQ,IACXS,EAASJ,EAAiBL,GAAS,KACnC,MACF,KAAKA,GAAS,KAAOA,EAAQ,IAC3BS,EAASJ,EAAiBL,EAAQ,KAAO,MACzC,MACF,KAAKA,GAAS,KAAOA,EAAQ,IAC3BS,EAASJ,EAAiBL,EAAQ,KAAO,MACzC,MACF,KAAKA,GAAS,KAAOA,EAAQ,KAC3BS,EAASJ,EAAiBL,EAAQ,KAAO,MACzC,MACF,KAAKA,GAAS,KACZS,EAASJ,EAAiBL,EAAQ,MAAQ,MAC1C,MACF,QACES,EAASJ,EAAiBL,GAAS,KAEvC,OAAOS,CAAM,EAGf,IAAIC,EAAkB,EAClBC,EAAe,EACfC,EAAgB,EAChBC,EAAkB,EAEtB,MAAO,CACLC,KAAM,iCACNC,eAAgBC,SAAUC,WAClBC,EAAS,CACbC,gBAAgB,EAChBC,SAAU,CAACC,EAASC,GAASC,WAAUC,aAAYC,UAASC,WAAUC,iBACpEjB,GAAmBX,EAAkByB,GACrCb,GAAgBZ,EAAkB0B,GAClCb,GAAiBb,EAAkB2B,GACnCb,GAAmBd,EAAkB4B,EAAW,IAEjDZ,kBAAkBE,GAErB,MAAMW,EAAS,GAAGvC,WAAqBA,IAAeA,IAAqBmB,EACzEE,KACErB,OAAkBA,aAAuBA,IAC3CA,IACCmB,EAAgBG,KAAgBtB,OAAkBA,YACnDA,IACCmB,EAAgBI,KAAiBvB,OAAkBA,WAAqBA,IACzEA,IACCmB,EAAgBK,KAEnBgB,QAAQC,IAAI,MACZD,QAAQC,IAAIzC,GACZwC,QAAQC,IAAIC,EAAM,GAAG1C,IAAsBuC,IAASvC,IAAgBE,GAAqB,EAE5F"}