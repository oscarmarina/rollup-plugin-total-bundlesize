"use strict";var e=require("boxen"),i=require("node:zlib"),t=require("terser");const n=e=>e.toLocaleString("en",{maximumFractionDigits:2}),r=e=>{switch(!0){case e<1e3:return n(e)+" B";case e>=1e3&&e<1e6:return n(e/1e3)+" KB";case e>=1e6&&e<1e9:return n(e/1e6)+" MB";case e>=1e9&&e<1e12:return n(e/1e9)+" GB";case e>=1e12:return n(e/1e12)+" TB";default:return n(e)+" B"}};function o(e={}){const{showGzippedSize:n=!0,showBrotliSize:o=!1,showMinifiedSize:l=!0,reporter:s}=e;return{name:"calculateBundleSizes",async generateBundle(e,a){await Promise.all(Object.values(a).filter(e=>e.type?"asset"!==e.type:!e.isAsset).map(a=>async function(e,a){const{code:c,fileName:u}=a,z={fileName:u};if(z.bundleSize=r(Buffer.byteLength(c)),z.brotliSize=o?r(i.brotliCompressSync(c).length):"",l||n){const e=(await t.minify(c)).code??c;z.minSize=l?r(e.length):"",z.gzipSize=n?r(i.gzipSync(e).length):""}s&&s({showGzippedSize:n,showBrotliSize:o,showMinifiedSize:l},e,z)}(e,a)))}}}const l="[0m",s="[93m",a="[36m",c="[90m",u="[32m";module.exports=({showFileDetail:i=!1,...t}={})=>{const n={padding:{top:0,right:1,bottom:0,left:1},title:"Total size",borderStyle:"single",...t},z=e=>{let[i,t]=e.split(" ");switch(i=parseFloat(i),t){case"B":default:return i;case"KB":return 1e3*i;case"MB":return 1e6*i;case"GB":return 1e9*i}};let S=0,$=0,d=0,m=0;const p=[];return{name:"rollup-plugin-total-bundlesize",generateBundle:async(...e)=>{await o({showBrotliSize:!0,reporter:(e,t,{fileName:n,bundleSize:r,minSize:o,gzipSize:l,brotliSize:s})=>{S+=z(r),$+=z(o),d+=z(l),m+=z(s),i&&p.push({fileName:n,bundleSize:r,minSize:o,gzipSize:l,brotliSize:s})}}).generateBundle(...e)},closeBundle(){if(i){console.log("");for(const e of p)console.log(`  ${u}${e.fileName}${l} â†’ ${e.bundleSize} (min: ${e.minSize}, gz: ${e.gzipSize}, br: ${e.brotliSize})`)}const t=`${a}Bundle:${l}${c}${r(S)}${l} | ${a}Minified:${l}${c}${r($)}${l} | ${a}Gzipped:${c}${r(d)}${l} | ${a}Brotli:${l}${c}${r(m)}`;console.log(l),console.log(e(`${s}${t}${l}`,n))}}};
//# sourceMappingURL=rollup-plugin-total-bundlesize.cjs.map
